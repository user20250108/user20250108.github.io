视频地址：*[田野-初等数论-2024.11.12](https://www.bilibili.com/video/av113475166671448)*

> ABCDE
{: .prompt-tip }

> FGHIJKLMN

### **命题1**

'''text
奇数$p$如果可以表示为两个正整数的平方和，那么$p \equiv 1 \mod 4$。
'''

### **命题1**
奇数$p$如果可以表示为两个正整数的平方和，那么$p \equiv 1 \mod 4$。

#### 证明
假设正整数$x$和$y$满足

$$p = x^2 + y^2$$

由于$p$是奇数，那么$x^2$和$y^2$一个是奇数，一个是偶数。这表明$x$和$y$一个是奇数，一个是偶数。不失一般性，此时假设$x$是奇数，$y$是偶数，即

$$x = 2m - 1, \quad y = 2n, \quad m \in \mathbb Z_+, \quad n \in \mathbb Z_+$$

此时

$$p = \left(2m - 1\right)^2 + \left(2n\right)^2 = 4m\left(m - 1\right) + 4n^2 + 1 = 1 \mod 4$$

命题得证。

### **推论2**
奇数的平方模$8$余$1$。

#### 证明
假设奇数表示为$2m - 1$，其中$m$是正整数。那么

$$\left(2m - 1\right)^2 = 4m\left(m - 1\right) + 1$$

由于$m\left(m - 1\right)$是偶数，所以推论得证。

### **定义1**
称方程$\alpha^2 + \beta^2 = \gamma^2$的正整数解$\left(\alpha,\beta,\gamma\right)$为勾股数。

### **命题3**
勾股数$\left(\alpha,\beta,\gamma\right)$乘以正整数$d$后还是勾股数$\left(d\alpha,d\beta,d\gamma\right)$。

### **命题4**
如果勾股数$\left(\alpha,\beta,\gamma\right)$中的两个不互素，那么它们的公因子也是第三个数的因子。

#### 证明
假设正整数$d > 1$满足$d \mid \alpha,d \mid \beta$，那么假设$\alpha = da,\beta = db$，其中$a$和$b$都是正整数，此时$\gamma^2 = d^2\left(a^2 + b^2\right)$，于是$d \mid \gamma$。其余两种情况类似，于是结论得证。

### **定义2**
称方程$\alpha^2 + \beta^2 = \gamma^2$两两互素的正整数解$\left(\alpha,\beta,\gamma\right)$ 为本原勾股数。

### **命题5**
本原勾股数$\left(\alpha,\beta,\gamma\right)$中的$\gamma$是奇数。

#### 证明
由于本原勾股数两两互素，所以三个数中必有奇数存在。根据奇偶数的加法，三个数中有且仅有两个奇数。如果这两个奇数是$\alpha$和$\beta$，那么根据奇数平方模$4$余$1$得到$\gamma^2 \equiv 2 \mod 4$，矛盾。于是这两个奇数中必有一个是$\gamma$。

### **定理6**
以下三个集合是等价的：
* 本原勾股数$\left(\alpha,\beta,\gamma\right)$，其中$\alpha$为偶数。
* 三元组$\left(2ab,a^2 - b^2,a^2 + b^2\right)$，其中$a > b$为互素的正整数，且$2 \nmid a + b$。
* 三元组$\left(\dfrac{c^2 - d^2}{2},cd,\dfrac{c^2 + d^2}{2}\right)$，其中$c > d$为互素的正整数，且$2 \nmid cd$。

#### 证明
假设本原勾股数$\left(\alpha,\beta,\gamma\right)$中$\alpha$为偶数，此时$\beta$和$\gamma$是奇数。注意到

$$\left(\frac{\alpha}{2}\right)^2 = \frac{\gamma + \beta}{2}\frac{\gamma - \beta}{2}$$

又因为

$$\gcd\left(\frac{\gamma + \beta}{2},\frac{\gamma - \beta}{2}\right) = d > 1 \implies d \mid \frac{\gamma + \beta}{2},d \mid \frac{\gamma - \beta}{2} \implies d \mid \gamma,d \mid \beta \implies \gcd\left(\gamma,\beta\right) = d$$

与假设矛盾，于是

$$\gcd\left(\dfrac{\gamma + \beta}{2},\dfrac{\gamma - \beta}{2}\right) = 1$$

根据算术基本定理，假设

$$\left(\frac{\alpha}{2}\right)^2 = p_1^{2r_1}p_2^{2r_2}\cdots p_s^{2r_s}, \quad r_1,r_2,\cdots,r_s \in \mathbb Z_+$$

其中$p_1,p_2,\cdots,p_s$为素数，那么只有两个完全平方数才能互素且乘积为$\left(\alpha / 2\right)^2$，假设它们是$a^2$和$b^2$，其中$a > b$为互素的正整数，此时

$$\gamma = a^2 + b^2, \quad \beta = a^2 - b^2 \implies \alpha = 2ab$$

到这里说明了所有的本原勾股数都可以写成三元组的形式

$$\left(\alpha,\beta,\gamma\right) \implies \left(2ab,a^2 - b^2,a^2 + b^2\right), \quad a > b, \quad \gcd\left(a,b\right) = 1$$

现在研究箭头的反向是否成立，即三元组两两互素。此时假设

$$\gcd\left(a^2 - b^2,a^2 + b^2\right) = d \implies d \mid a^2 - b^2,d \mid a^2 + b^2 \implies d \mid 2a^2,d \mid 2b^2 \implies d \mid 2$$

无法推出$d = 1$，其中最后一步使用了$\gcd\left(a,b\right) = 1$的条件。如果取$d = 2$就表明此时的三元组会同时是偶数，所以加入条件$2 \nmid a + b$，这意味着$2 \nmid a - b,2 \nmid a^2 - b^2,2 \nmid a^2 + b^2$，此时就有$\gcd\left(a^2 - b^2,a^2 + b^2\right) = 1$。进一步验证如下

$$\gcd\left(2ab,a^2 + b^2\right) = d \implies d \mid \left(a + b\right)^2,d \mid \left(a - b\right)^2$$

根据算术基本定理，假设$d = p_1^{r_1}p_2^{r_2}\cdots p_s^{r_s},r_1,r_2,\cdots,r_s \in \mathbb Z_+$，其中$p_1,p_2,\cdots,p_s$为素数，那么存在$f = p_1p_2\cdots p_s$使得$f \mid a + b,f \mid a - b$，这给出$f \mid 2a,f \mid 2b \implies f \mid 2$。结合$2 \nmid a^2 + b^2$ 就能够得到$f = 1,d = 1$。此时得到

$$\gcd\left(a^2 - b^2,a^2 + b^2\right) = 1, \quad \gcd\left(2ab,a^2 + b^2\right) = 1 \implies \gcd\left(2ab,a^2 - b^2\right) = 1$$

说明下面的等价式是成立的

$$\left(\alpha,\beta,\gamma\right) \iff \left(2ab,a^2 - b^2,a^2 + b^2\right), \quad a > b, \quad \gcd\left(a,b\right) = 1, \quad 2 \nmid a + b$$

即定理中前两个集合等价。

通过等式

$$\beta^2 = \left(\gamma + \alpha\right)\left(\gamma - \alpha\right)$$

注意到$\gamma + \alpha$和$\gamma - \alpha$都为奇数，于是根据

$$\gcd\left(\gamma + \alpha,\gamma - \alpha\right) = g \implies g \mid \gamma + \alpha,g \mid \gamma - \alpha \implies g \mid 2\gamma,g \mid 2\alpha \implies g \mid 2$$

得到$g = 1$，即$\gamma + \alpha$和$\gamma - \alpha$是互素的。同样地，只有两个完全平方数才能互素且乘积为$\beta^2$，假设它们是$c^2$和$d^2$，其中$c > d$为互素的正整数，此时

$$\gamma = \frac{c^2 + d^2}{2}, \quad \alpha = \frac{c^2 - d^2}{2} \implies \beta = cd$$

到这里说明了所有的本原勾股数都可以写成三元组的形式

$$\left(\alpha,\beta,\gamma\right) \implies \left(\frac{c^2 - d^2}{2},cd,\frac{c^2 + d^2}{2}\right), \quad c > d, \quad \gcd\left(c,d\right) = 1, \quad 2 \nmid cd$$

最后一个条件来自$c^2 = \gamma + \alpha$和$d^2 = \gamma - \alpha$都为奇数。现在研究箭头的反向是否成立，即三元组两两互素。假设

$$\gcd\left(cd,\frac{c^2 + d^2}{2}\right) = g \implies g \mid cd,g \mid \frac{c^2 + d^2}{2} \implies g \mid \frac{\left(c + d\right)^2}{2},g \mid \frac{\left(c - d\right)^2}{2}$$

由于$2 \nmid cd$，所以$2 \nmid g$，这表明

$$g \mid \frac{\left(c + d\right)^2}{4},g \mid \frac{\left(c - d\right)^2}{4}$$

假设$g = p_1^{r_1}p_2^{r_2}\cdots p_s^{r_s},r_1,r_2,\cdots,r_s \in \mathbb Z_+$，其中$p_1,p_2,\cdots,p_s$ 为素数，那么存在$h = p_1p_2\cdots p_s$使得

$$h \mid \frac{c + d}{2},h \mid \frac{c - d}{2} \implies h \mid c,h \mid d \implies h = 1$$

从而得到$g = 1$。同样可以得到

$$\gcd\left(\frac{c^2 - d^2}{2},\frac{c^2 + d^2}{2}\right) = g \implies g \mid \frac{c^2 - d^2}{2},g \mid \frac{c^2 + d^2}{2} \implies g \mid c^2,g \mid d^2 \implies g = 1$$

说明下面的等价式是成立的

$$\left(\alpha,\beta,\gamma\right) \iff \left(\frac{c^2 - d^2}{2},cd,\frac{c^2 + d^2}{2}\right), \quad c > d, \quad \gcd\left(c,d\right) = 1, \quad 2 \nmid cd$$

定理证完。

### **命题7**
本原勾股数$\left(\alpha,\beta,\gamma\right)$与曲线$x^2 + y^2 = 1$在第一象限的有理点一一对应。

#### 证明
通过变换$x = \alpha / \gamma,y = \beta / \gamma$容易得到

$$\alpha^2 + \beta^2 = \gamma^2, \quad \alpha,\beta,\gamma \in \mathbb Z \implies x^2 + y^2 = 1, \quad x,y \in \mathbb Q$$

现在研究箭头的反向是否成立。考虑有理点$\left(p_1 / q_1,p_2 / q_2\right)$满足曲线方程，此时$\gcd\left(p_1,q_1\right) = 1,\gcd\left(p_2,q_2\right) = 1$，根据曲线方程

$$\left(\frac{p_1}{q_1}\right)^2 + \left(\frac{p_2}{q_2}\right)^2 = 1 \implies p_1^2q_2^2 + p_2^2q_1^2 = q_1^2q_2^2$$

能够得到

$$p_1^2q_2^2 = q_1^2\left(q_2^2 - p_2^2\right) \implies q_1 \mid p_1q_2 \implies q_1 \mid q_2$$

同理得到$q_2 \mid q_1$，于是$q_1 = q_2$，通过变换$\alpha = p_1,\beta = p_2,\gamma = q_1$即可变为本原勾股数，命题得证。

### *注1*
相交直线系数的有理性可以得到二次曲线上的有理点。考虑直线$y = m\left(x + 1\right)$与曲线$x^2 + y^2 = 1$ 的交点

$$\left(x,y\right) = \left(-1,0\right), \quad \left(x,y\right) = \left(\frac{1 - m^2}{1 + m^2},\frac{2m}{1 + m^2}\right)$$

当$0 < m < 1$时，第二个交点在第一象限内。假设第二个交点为有理点，有

$$\left(\frac{1 - m^2}{1 + m^2},\frac{2m}{1 + m^2}\right) = \left(\frac \alpha\gamma,\frac \beta\gamma\right), \quad m = \left(1 - \frac{1 - m^2}{1 + m^2}\right) / \frac{2m}{1 + m^2} = \frac{\gamma - \alpha}{\beta}$$

于是$x,y \in \mathbb Q \implies m \in \mathbb Q$。反过来，如果$m$是有理数，假设$m = p / q$，其中$\gcd\left(p,q\right) = 1$，那么

$$x = \frac{1 - m^2}{1 + m^2} = \frac{q^2 - p^2}{q^2 + p^2}, \quad y = \frac{2m}{1 + m^2} = \frac{2pq}{q^2 + p^2}$$

此时$x,y \in \mathbb Q \iff m \in \mathbb Q$。现在查看$x$和$y$的表达式是否是有理数的最简表示，根据

$$\gcd\left(q^2 - p^2,q^2 + p^2\right) = d \implies d \mid q^2 - p^2,d \mid q^2 + p^2 \implies d \mid 2q^2,d \mid 2p^2 \implies d \mid 2$$

此时$d$不一定为$1$。如果$p$和$q$是一个奇数一个偶数，即$2 \nmid p + q$，那么有$2 \nmid p - q,2 \nmid p^2 - q^2$，才能得到$d = 1$。如果$p$和$q$是两个奇数，即$2 \nmid pq$，那么有$2 \mid p + q,2 \mid p^2 - q^2,2 \mid p^2 + q^2$，得到$d = 2$。于是

$$m = \frac{p}{q} \implies
\begin{cases}
\alpha = q^2 - p^2,\beta = 2pq,\gamma = q^2 + p^2, \quad 2 \nmid p + q \\
\alpha = \dfrac{q^2 - p^2}{2},\beta = pq,\gamma = \dfrac{q^2 + p^2}{2}, \quad 2 \nmid pq
\end{cases}$$

对于$2 \nmid p + q$的情况，注意到$2 \mid 2pq$，所以此时的$\beta$是偶数，对于$2 \nmid pq$的情况，由于$2 \mid p + q,2 \mid p - q$，此时可以得到$4 \mid p^2 - q^2$，于是$\alpha$是偶数。

### **命题8[Fermat,1640]**
不存在面积为$1$的三边有理的直角三角形。

#### 证明
假设这样的三角形存在，设三边边长都乘以$k$倍后为正整数$\alpha,\beta,\gamma$，此时满足

$$\alpha^2 + \beta^2 = \gamma^2, \quad \frac 12\alpha\beta = k^2$$

假设$k$足够小使得$\gcd\left(\alpha,\beta,\gamma\right) = 1$，那么可以得到它们两两互素，此时三元组$\left(\alpha,\beta,\gamma\right)$是本原勾股数。假设$a > b$是两个互素的正整数，并且$2 \nmid a + b$，此时本原勾股数可表示为$\left(2ab,a^2 - b^2,a^2 + b^2\right)$。它们的面积满足

$$ab\left(a - b\right)\left(a + b\right) = k^2$$

由于$a,b$互素，所以上述四个正整数$a,b,a - b,a + b$两两互素，于是它们都是互素的完全平方数。现在假设

$$a = r^2, \quad b = s^2, \quad a - b = v^2, \quad a + b = u^2$$

构造三角形的三边分别为$\left(u - v\right) / 2,\left(u + v\right) / 2,r$，根据

$$\left(\frac{u - v}{2}\right)^2 + \left(\frac{u + v}{2}\right)^2 = r^2$$

可以知道此时三角形是直角三角形，$r$是斜边。并根据

$$\gcd\left(\frac{u - v}{2},\frac{u + v}{2}\right) = d \implies d \mid \frac{u - v}{2},d \mid \frac{u + v}{2} \implies d \mid u,d \mid v \implies d = 1 \\
\gcd\left(r^2,u^2\right) = 1,\gcd\left(r^2,v^2\right) = 1 \implies \gcd\left(r,u\right) = 1,\gcd\left(r,v\right) = 1 \implies \gcd\left(r,\frac{u + v}{2}\right) = 1$$

得到此时三角形三边为本原勾股数。它的面积为

$$\frac 12\frac{u - v}{2}\frac{u + v}{2} = \left(\frac s2\right)^2$$

由于$2 \nmid a + b$，于是$u$和$v$都是奇数，此时$2 \mid u + v,2 \mid u - v,4 \mid u^2 - v^2,2 \mid s^2$，于是$s$ 是偶数。显然新构造的直角三角形的面积也是完全平方数，并且根据$a > b$注意到

$$k^2 = ab\left(a - b\right)\left(a + b\right) = r^2s^2\left(r^2 - s^2\right)\left(r^2 + s^2\right) \geqslant r^2s^2\left(r^2 + s^2\right) > 2s^6 > \left(\frac s2\right)^2$$

于是可以无穷次构造出面积减小的三角形，但完全平方数最小是$1$，所以矛盾，于是这样的三角形不存在。

### **定义3**
如果存在面积为正整数$n$的三边有理的直角三角形，称$n$为同余数。

### *注2*
当考虑面积为$n$的直角三角形时，可以按照与$n = 1$时类似的方法考虑等式

$$ab\left(a - b\right)\left(a + b\right) = nk^2$$

假设$n \mid b$，于是考虑如下假设

$$a = r^2, \quad b = ns^2, \quad a - b = v^2, \quad a + b = u^2$$

构造直角三角形，它的三边为本原勾股数$\left(u - v\right) / 2,\left(u + v\right) / 2,r$。它的面积为

$$\frac 12\frac{u - v}{2}\frac{u + v}{2} = n\left(\frac s2\right)^2$$

现在将新的三角形三边用三元组$\left(2a_1 b_1,a_1^2 - b_1^2,a_1^2 + b_1^2\right)$表示，进而得到

$$a = r^2 = \left(a_1^2 + b_1^2\right)^2, \quad b = ns^2 = 2\frac{u - v}{2}\frac{u + v}{2} = 4a_1b_1\left(a_1^2 - b_1^2\right)$$

如果存在直角三角形使得$n$为同余数，那么可以解出对应的$a_1,b_1$，构造出另一个面积为$n$的三边有理的直角三角形。

### *注3*
如果对上述等式变形可以得到

$$\frac ab\left(\frac ab - 1\right)\left(\frac ab + 1\right) = n\left(\frac{k}{b^2}\right)^2$$

这表明$n$是同余数时，三边有理的直角三角形会对应曲线$ny^2 = x\left(x - 1\right)\left(x + 1\right)$ 上的有理点。如果直线与曲线有三个交点，考虑直线已经经过曲线上的两个有理点$\left(x_1,y_1\right),\left(x_2,y_2\right)$，那么它与曲线的交点方程为

$$x^3 - x - n\left[\frac{y_2 - y_1}{x_2 - x_1}\left(x - x_1\right) + y_1\right]^2 = 0$$

考虑等价的形式

$$\left(x - x_1\right)\left(x - x_2\right)\left(x - x_3\right) = 0$$

其中$\left(x_3,y_3\right)$是第三个交点。比较关于$x$的常数项得到

$$-x_1x_2x_3 = -n\left(y_1 - \frac{y_2 - y_1}{x_2 - x_1}x_1\right)^2 \implies x_3 = n\frac{x_1}{x_2}\left(\frac{y_1}{x_1} - \frac{y_2 - y_1}{x_2 - x_1}\right)^2$$

同样的方式可以得到

$$y_3 = \frac{1}{y_2}\left(\frac{y_2 - y_1}{x_2 - x_1}\right)^2\left(\frac{y_2 - y_1}{x_2 - x_1}\frac{x_1}{y_1} - 1\right) - \frac{y_1^2}{y_2}\left(\frac{y_2 - y_1}{x_2 - x_1}\frac{x_1}{y_1} - 1\right)^3$$

这说明第三个交点也是有理点。现在考虑$\left(x_1,y_1\right)$和$\left(x_2,y_2\right)$趋于同一个点$\left(x_0,y_0\right)$，此时两个交点变为切点，斜率为

$$\lim_{x_2 \rightarrow x_1 = x_0} \frac{y_2 - y_1}{x_2 - x_1} = \frac{3x_0^2 - 1}{2ny_0}$$

代入得到第三个交点的位置

$$x_3 = n\left(\frac{y_0}{x_0} - \frac{3x_0^2 - 1}{2ny_0}\right)^2, \quad y_3 = \frac{1}{y_0}\left(\frac{3x_0^2 - 1}{2ny_0}\right)^2\left(\frac{3x_0^2 - 1}{2ny_0}\frac{x_0}{y_0} - 1\right) - y_0\left(\frac{3x_0^2 - 1}{2ny_0}\frac{x_0}{y_0} - 1\right)^3$$

现在考虑初始点

$$\left(x_0,y_0\right) = \left(\frac{a_1}{b_1},\frac{s}{2b_1^2}\right)$$

代入得到第三个交点

$$x_3 = n\left(\frac{s}{2a_1b_1} - \frac{3a_1^2 - b_1^2}{ns}\right)^2 = \frac{ns^2}{4a_1^2b_1^2} + \frac{\left(3a_1^2 - b_1^2\right)^2}{ns^2} - \frac{3a_1^2 - b_1^2}{a_1b_1} = \frac{\left(a_1^2 + b_1^2\right)^2}{4a_1b_1\left(a_1^2 - b_1^2\right)} = \frac{a}{b} \\
y_3 = \frac{2b_1^2}{s}\left(\frac{3a_1^2 - b_1^2}{ns}\right)^2\left(\frac{3a_1^2 - b_1^2}{ns}\frac{2a_1b_1}{s} - 1\right) - \frac{s}{2b_1^2}\left(\frac{3a_1^2 - b_1^2}{ns}\frac{2a_1b_1}{s} - 1\right)^3 = \frac{s\left(a_1^2 + b_1^2\right)\left(a_1^4 - 6a_1^2b_1^2 + b_1^4\right)}{16a_1^2b_1^2\left(a_1^2 - b_1^2\right)^2}$$

之前的等式可以变形为

$$k^2 = as^2\left(a - b\right)\left(a + b\right) = s^2\left(a_1^6 - 5a_1^4b_1^2 - 5a_1^2b_1^4 + b_1^6\right)^2 =\left[s\left(a_1^2 + b_1^2\right)\left(a_1^4 - 6a_1^2b_1^2 + b_1^4\right)\right]^2$$

这表明$y_3 = k / b^2$，与之前构造新直角三角形的结果一致。
